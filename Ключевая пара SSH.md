# Сценарий создания и настройки ключевой пары SSH

## Аннотация
Настоящий документ является кратким описанием последовательности действий при создании/настройке ключевых пар SSH.
Более подробная информация об используемых командах и режимах их работы доступна в справочном руководстве из состава операционной системы. 

## Создание ключевой пары
Для создания ключевой пары требуется выполнить следующую команду:
*ssh-keygen*
Эта команда по умолчанию создает ключевую пару RSA длиной 2048 бит и сохраняет ее в каталоге *~/.ssh*. Закрытый ключ создается с именем *id_rsa*, публичный — *id_rsa.pub*.
Команда позволяет задавать следующие параметры:
- тип ключевой пары;
- длина ключевой пары;
- каталог для сохранения ключевой пары;
- имена файлов ключевой пары;
- возможность перезаписи созданной ранее ключевой пары;
- ключевая фраза.

## Копирование открытой части ключевой пары на сервер
Для копирования следует вывести содержимое файла *id_rsa.pub* в стандартный поток вывода:
*cat ~/.ssh/id_rsa.pub*
Далее на сервере необходимо создать папку *~/.ssh*:
*mkdir -p ~/.ssh*
Затем требуется дописать открытую часть ключевой пары на сервер в конец файла *authorized_keys*:
*echo строка_публичного_ключа >> ~/.ssh/authorized_keys*
В данном случае в качестве параметра *строка_публичного_ключа* следует использовать вывод команды *cat ~/.ssh/id_rsa.pub*.
После этого необходимо убедиться, что директория *~/.ssh* и файл *authorized_keys* имеют соответствующие права доступа:
*chmod -R go= ~/.ssh*
Далее следует поменять права пользователя, чтобы директория и файлы ключей принадлежали пользователю, а не root.
*chown -R user:user ~/.ssh*
В данном случае в качестве параметра *user* необходимо указать имя требуемого пользователя.

## Подключение к серверу и отключение доступа по паролю
Для подключения к серверу следует выполнить следующую команду:
*ssh username@server*
В данном случае в качестве параметра *username* необходимо указать имя требуемого пользователя, а в качестве параметра *server* — имя или адрес сервера.
Далее требуется отредактировать файл */etc/ssh/sshd_config*. В данном файле необходимо установить значение "no" для поля "PasswordAuthentication".
После этого следует перезапустить демон sshd:
*sudo systemctl restart ssh*
